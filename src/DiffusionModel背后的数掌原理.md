
P2   
## åŸºæœ¬æ¦‚å¿µ 

![](./assets/lhy3-2.png) 


P3   
## VAE vs. Diffusion Model 

![](./assets/lhy3-2.png) 

P5   
## <u>Training</u> 

![](./assets/lhy3-5.png) 

> &#x2705; çº¢æ¡†ï¼š\\(X_o\\) ä¸ noise åšåŠ æƒå¹³å‡ï¼Œæƒé‡æ˜¯é¢„å®šä¹‰å¥½çš„ã€‚å¾—åˆ°çš„æ˜¯å¸¦å™ªå£°å›¾åƒï¼Œ\\(\alpha \\) è¶Šæ¥è¶Šå°ï¼Œå³å™ªå£°è¶Šæ¥è¶Šå¤šã€‚   
> &#x2705; \\(\epsilon_\theta \\) çš„é¢„æµ‹ç»“æœåº”è¶‹è¿‘äº \\(\epsilon\\) ã€‚   


P6

![](./assets/lhy3-6.png) 

P7   

|||
|--|--|
| æƒ³åƒä¸­â€¦ | ![](./assets/lhy3-7-1.png)  |
| å®é™…ä¸Šâ€¦  | ![](./assets/lhy3-7-2.png)  |


> &#x2705; ä¸Šé¢è¿‡ç¨‹å°†åŠ å™ªè¿‡ç¨‹é€æ­¥æ‹†è§£ï¼Œæ˜¯ä¸ºäº†å¸®åŠ©ç†è§£é€æ­¥å»å™ªçš„è¿‡ç¨‹ã€‚ä½†å®é™…ä¸Šï¼Œå…¬å¼å¯ä»¥è¯æ˜ï¼Œé€æ­¥åŠ å™ªå’Œä¸€æ­¥åŠ å™ªåœ¨æ•°å­¦ä¸Šæ˜¯ç­‰ä»·çš„ã€‚   


P8   
## <u> Inference </u> 

![](./assets/lhy3-8-1.png) 


![](./assets/lhy3-8-2.png) 

> &#x2705; \\(X_T\\) æ˜¯åˆå§‹å™ªå£°ï¼Œæ¯ä¸ª step è¿˜è¦æ¯æ¬¡é¢å¤–ç”Ÿæˆä¸€ä¸ªå™ªå£°\\(Z\\).   
> &#x2705; \\(\alpha \\) å’Œ \\( \bar{\alpha } \\) æ˜¯ä¸¤ç»„æ•°å€¼åºåˆ—ã€‚   


P9   

> &#x2705; çº¢åœˆæ˜¯ä¸€ä¸ªç®€å•çš„åˆ†å¸ƒï¼Œä¾‹äºæ ‡å‡†é«˜æ–¯ï¼Œé€šè¿‡ NN çš„è½¬æ¢ï¼Œåˆæˆä¸€ä¸ªå¤æ‚çš„åˆ†å¸ƒï¼ŒæœŸæœ›è¿™ä¸ªåˆ†å¸ƒä¸çœŸæ­£çš„å›¾åƒåˆ†å¸ƒæ˜¯ä¸€è‡´çš„ã€‚   


P10   
## å½±åƒç”Ÿæˆæ¨¡å‹æœ¬è´¨ä¸Šçš„å…±åŒç›®æ ‡

![](./assets/lhy3-10.png) 

> &#x2705; å®é™…ä½¿ç”¨ä¸­è¿˜ä¼šåŠ ä¸€ä¸ª conditionï¼Œä½†æ•´ä½“ä¸Šæ²¡æœ‰æœ¬è´¨å·®å¼‚ï¼Œå› æ­¤åé¢æ¨å¯¼ä¸­ä¸è€ƒè™‘ condition.    



P11   
## Maximum Likelihood Estimation

![](./assets/lhy3-11.png) 

Sample {\\(x^1,x^2,\cdots ,x^m\\)} from \\(P_{data}(x)\\)    

We can compute \\(P_\theta (x^i)\\)    

\begin{align*} \theta ^\ast =\text{arg } \max_{\theta } \prod_{i=1}^{m} P_\theta (x^i) \end{align*}


> &#x2753; æ€æ ·è¡¡é‡ä¸¤ä¸ªåˆ†å¸ƒæ˜¯å¦æ¥è¿‘ï¼Ÿ   
> &#x2705; \\(P_{data}\\) ä»£è¡¨çœŸå®åˆ†å¸ƒï¼Œä»åˆ†å¸ƒä¸­ Sample å‡ºæ¥çš„ \\(x\\) å³è®­ç»ƒé›†    
> &#x2705; \\(P_\theta (x^i)\\) ä»£æœ‰ \\(P_\theta\\) ç”Ÿæˆ \\(x^i\\) çš„æ¦‚ç‡ï¼Œä½†ç”±äº \\(P_\theta\\) éå¸¸å¤æ‚ï¼Œç®—ä¸å‡ºè¿™ä¸ªæ¦‚ç‡ï¼Œä½†æ­¤å¤„å‡è®¾ \\(P_\theta (x^i)\\) å·²çŸ¥ã€‚    
> &#x2705; ç›®æ ‡ï¼šæ‰¾å‡ºè®©çœŸå® \\(x^i\\) è¢«ç”Ÿæˆå‡ºæ¥çš„æ¦‚ç‡æœ€é«˜çš„\\(\theta \\).    


P12  

![](./assets/lhy3-12.png) 


Maximum Likelihood = Minimize KL Divergence    

> &#x2705; ç»“è®ºï¼šè®©çœŸå®æ•°æ®çš„æ¦‚ç‡æœ€å¤§ï¼Œä¸è®©ä¸¤ä¸ªåˆ†å¸ƒå°½é‡æ¥è¿‘ï¼Œåœ¨æ•°å­¦ä¸Šæ˜¯ä¸€è‡´çš„ã€‚   
> &#x2705; VAEã€diffusionã€flow based ç­‰ç”Ÿæˆæ¨¡å‹ï¼Œéƒ½æ˜¯ä»¥æœ€å¤§åŒ– Likelihood ä¸ºç›®æ ‡ã€‚GAN æ˜¯æœ€å°åŒ– JS Divergence ä¸ºç›®æ ‡ã€‚   


P13   
## VAE: Compute \\(ğ‘ƒ_\theta(x)\\)   

|||
|--|--|
| ![](./assets/lhy3-13-1.png) | ![](./assets/lhy3-13-2.png) |
| ![](./assets/lhy3-13-3.png) | ![](./assets/lhy3-13-4.png) |


> &#x2705; VAE å’Œ diffusion éå¸¸ç›¸ä¼¼ï¼Œè®¸å¤šå…¬å¼æ˜¯é€šç”¨çš„ã€‚    
> &#x2705; \\(Gï¼ˆzï¼‰\\) ä¸ä»£è¡¨æŸä¸ªç”Ÿæˆç»“æœï¼Œè€Œæ˜¯ä¸€ä¸ªé«˜æ–¯çš„å‡å€¼ï¼Œç„¶åè®¡ç®— \\(x\\) åœ¨è¿™ä¸ªåˆ†å¸ƒä¸­çš„æ¦‚ç‡ã€‚   


P14   
## VAE: Lower bound of \\(log P(x)\\)  

![](./assets/lhy3-14.png)


> &#x2705; é€šå¸¸æ— æ³•æœ€å¤§åŒ– \\(Pï¼ˆxï¼‰\\)ï¼Œè€Œæ˜¯æœ€å¤§åŒ– \\(log P(x)\\) çš„ä¸‹ç•Œã€‚  
> &#x2705; ä»¥ä¸‹å…¬å¼æ¨å¯¼ä¸­çœç•¥å‚æ•° \\( \theta\\)ã€‚   


P15   
## DDPM: Compute \\(ğ‘ƒ_\theta(x)\\)   

![](./assets/lhy3-15.png)  

$$
P_ \theta (x_0)=\int\limits _ {x_1:x_T}^{} P(x_T)P_ \theta (x_{T-1}|x_T) \dots P_ \theta (x_ {t-1}|x_t) \dots P_ \theta(x_0|x_1)dx_1:x_T  
$$

> &#x2705; å¯¹äº diffusion modelï¼Œæ¯æ¬¡ denoise å‡ºçš„æ˜¯ä¸€ä¸ªé«˜æ–¯åˆ†å¸ƒçš„å‡å€¼ã€‚   
> &#x2705; å¾—å‡º \\(x_0\\) åœ¨æœ€ç»ˆåˆ†å¸ƒä¸­çš„æ¦‚ç‡ã€‚   
> &#x2753; é—®é¢˜ï¼Œä¸ºä»€ä¹ˆå‡è®¾\\(G(x_t)\\) æ˜¯é«˜æ–¯åˆ†å¸ƒçš„ meanï¼Ÿ   
> &#x2705; ç­”ï¼šæœ‰äººå°è¯•è¿‡å…¶å®ƒå‡è®¾ï¼Œæ•ˆæœæ²¡æœ‰å˜å¥½ï¼Œä¸”é«˜æ–¯åˆ†å¸ƒä¾¿äºè®¡ç®—ã€‚   

P16   
## DDPM: Lower bound of \\(log P(x)\\)  

![](./assets/lhy3-16-1.png)  

![](./assets/lhy3-16-2.png)  



P17   
![](./assets/lhy3-17.png)  

> &#x2705; æå‰å®šå¥½ä¸€ç»„ \\(\beta \\)ï¼ä»£è¡¨ noise è¦åŠ å¤šå¤§ã€‚   
> &#x2705; \\(qï¼ˆx_tï½œx_{t-1}ï¼‰\\) ä»ç„¶å±äºé«˜æ–¯åˆ†å¸ƒï¼Œå…¶å‡å€¼ä¸º \\(\sqrt{1-\beta _t} \cdot x_t\\)ï¼Œæ–¹å·®ä¸º \\(\beta _t\\).   



P18   
![](./assets/lhy3-18.png)  

> &#x2705; ä¸¤æ¬¡ sample å‡ºçš„ noise æ˜¯ç‹¬ç«‹åŒåˆ†å¸ƒã€‚   

P19   
![](./assets/lhy3-19.png)  

> &#x2705; ä¸¤ä¸ª noise ä»¥è¿™ç§å½¢å¼ç›¸åŠ çš„ç»“æœï¼Œä¹Ÿç¬¦åˆæŸä¸ªç‰¹å®šçš„é«˜æ–¯åˆ†å¸ƒã€‚   

P20   
![](./assets/lhy3-20.png)  

> &#x2705; ç»“è®ºï¼š\\( x_t=\sqrt{\bar{\alpha }_t}  \cdot x_0+\sqrt{1-\bar{\alpha }_t} \cdot \varepsilon \\).    


P21   
![](./assets/lhy3-21.png)  



P22   
## DDPM: Lower bound of \\(log P(x)\\)  

\begin{align*} E_{q(x_1|x_0)}[log P(x_0|x_1)]-KL(q(x_T|x_0)||P(x_T))\\\\
-\sum_{t=2}^{T}E_{q(x_t|x_0)}[KL(q(x_{t-1}|x_t,x_0)||P(x_{t-1}|x_t))]   \end{align*}


> &#x2705; ç›®æ ‡æ˜¯è¦ä¼˜åŒ– \\( \theta\\)ï¼Œç¬¬äºŒé¡¹ä¸\\( \theta\\)æ— å…³ï¼Œå¯ä»¥ç•¥æ‰ã€‚   
> &#x2705; ç¬¬ä¸‰é¡¹çš„ KL Divrgence æ¶‰åŠåˆ°ä¸¤ä¸ªåˆ†å¸ƒï¼Œåˆ†å¸ƒ1æ˜¯å›ºå®šçš„ï¼Œå¯ä»¥é€šè¿‡è®¡ç®—å¾—åˆ°ï¼Œåˆ†å¸ƒ2æ˜¯ç”± \\( \theta\\) å†³å®šçš„ï¼Œæ˜¯è¦ä¼˜åŒ–çš„å¯¹è±¡ã€‚   


P23  

![](./assets/lhy3-23-1.png)  


![](./assets/lhy3-23-2.png)  


> &#x2705; å·²çŸ¥ \\(q (x_t\mid x_0)\\)ï¼Œ\\(q (x_{t-1} \mid x_0)\\) å’Œ \\(q (x_t \mid x_{t-1})\\)ï¼Œæ±‚ \\(q (x_{t-1} \mid x_t,x_0)\\).   



P24   
![](./assets/lhy3-24.png)  

> &#x2705; å·²çŸ¥\\(x_0\\) å’Œ \\(x_t\\)ï¼Œæ±‚ \\(x_{t-1}\\) çš„åˆ†å¸ƒã€‚   


P25   
![](./assets/lhy3-25.png)  

<https://arxiv.org/pdf/2208.11970.pdf>


P26   
![](./assets/lhy3-26.png)  

> &#x2705; ç»“è®ºï¼š\\(q(x_{t-1}|x_t,x_0)\\) ä¹Ÿæ˜¯é«˜æ–¯åˆ†å¸ƒã€‚   


P27   
![](./assets/lhy3-27-1.png)  

How to minimize KL divergence?    

![](./assets/lhy3-27-2.png)  


![](./assets/lhy3-27-3.png)  


> &#x2705; ä¸¤ä¸ªé«˜æ–¯åˆ†å¸ƒçš„ KLD æœ‰å…¬å¼è§£ï¼Œä½†æ­¤å¤„ä¸åŒå…¬å¼è§£ä¸º  \\( \theta\\) åªèƒ½å½±å“åˆ†å¸ƒ2çš„å‡å€¼ã€‚   
> &#x2705; å› æ­¤å‡å° KLD çš„æ–¹æ³•æ˜¯è®©åˆ†å¸ƒ2çš„å‡å€¼æ¥è¿‘åˆ†å¸ƒå‡å€¼ã€‚   



P28   
![](./assets/lhy3-28-1.png)  

![](./assets/lhy3-28-2.png)  


> &#x2705; åˆ†å¸ƒ1çš„å‡å€¼å¯ä»¥çœ‹ä½œæ˜¯ \\(x_{t-1}\\) çš„ GT äº†ã€‚   


P31   
![](./assets/lhy3-31.png)  


> &#x2705; å…·ä½“çš„è®­ç»ƒæ–¹æ³•ï¼š    
> &#x2705;ï¼ˆ1ï¼‰å–ä¸€ä¸ªæ•°æ®ä½œä¸º \\(x_0\\)ã€‚   
> &#x2705;ï¼ˆ2ï¼‰sample å‡º \\(\varepsilon \\)ï¼Œè®¡ç®— \\(x_t\\).   
> &#x2705;ï¼ˆ3ï¼‰æ ¹æ®å…¬å¼ï¼Œç”¨ \\(x_t\\) æ¥è¡¨ç¤º \\(x_{t-1}\\) åˆ†å¸ƒçš„å‡å€¼ï¼Œå‘ç° \\(x\\) ä¸ \\(x_{t-1}\\) ä¹‹é—´ç›¸å·®ä¸€ä¸ª noiseï¼   
> &#x2705;ï¼ˆ4ï¼‰ç”¨ç½‘ç»œå­¦ä¹ è¿™ä¸ª noise.   


P32   
![](./assets/lhy3-32-1.png)  

![](./assets/lhy3-32-2.png)  

> &#x2705; å› ä¸ºå”¯ä¸€æœªçŸ¥çš„éƒ¨åˆ†å°±æ˜¯ \\(\varepsilon \\).   
> &#x2705; \\(\alpha \\) æ˜¯é¢„å®šä¹‰çš„è¶…å‚ï¼ŒDDPM è¯•å›¾å­¦ä¹  \\(\alpha \\)ï¼Œå‘ç°æ²¡æœ‰æå‡ã€‚


P33   
![](./assets/lhy3-33.png)  

ä¸ºä»€ä¹ˆä¸ç›´æ¥å– Meanï¼Ÿ


> &#x2753; é¢„æµ‹å‡ºçš„é«˜æ–¯å‡å€¼æ˜¯æœ€å¤§æ¦‚ç‡çš„å€¼ï¼Œä¸ºä»€ä¹ˆä¸ç›´æ¥å–å‡å€¼ï¼Ÿè€Œæ˜¯è¦å† sample ä¸€æ¬¡ï¼Ÿ   



P34   
## å…è´£å£°æ˜ï¼šä»¥ä¸‹åªæ˜¯çŒœæµ‹    

P35   
## ä¸ºä»€ä¹ˆç”Ÿæˆæ–‡å¥æ—¶éœ€è¦ Sampleï¼Ÿ

> &#x2705; å¾ˆå¤šç”Ÿæˆç®—æ³•éƒ½ä¸ç›´æ¥ç”Ÿæˆç»“æœï¼Œè€Œæ˜¯ç”Ÿæˆåˆ†å¸ƒå† sample.  

P36  
## ä¸ºä»€ä¹ˆç”Ÿæˆæ–‡å¥æ—¶éœ€è¦ Sampleï¼Ÿ

 - The Curious Case of Neural Text Degeneration   

<https://arxiv.org/abs/1904.09751>  

![](./assets/lhy3-36.png)  

> &#x2705; å› ä¸ºï¼šï¼ˆ1ï¼‰æ¯æ¬¡å–æ¦‚ç‡æœ€å¤§çš„å€¼ï¼Œä¼šå¯¼è‡´ç”Ÿæˆé‡å¤ç»“æœã€‚    

P37   
![](./assets/lhy3-37.png)  

> &#x2705; æ•°æ®åˆ†æå‘ç°ï¼Œäººå†™æ–‡ç« å¤§å¤šæ•°ä¸æ˜¯é€‰æ¦‚ç‡æœ€å¤§çš„è¯ã€‚   

P39   
## Diffusion Model æ˜¯ä¸€ç§ Autoregressive 


![](./assets/lhy3-39.png)  



P43   
## Diffusion Model for Text

 - Difficulty:    
 - Solution: Noise on latent space    

![](./assets/lhy3-43.png)  

<https://arxiv.org/abs/2205.14217>

> &#x2705; æ–‡å­—æ˜¯ç¦»æ•£çš„ï¼Œä¸èƒ½ç›´æ¥åŠ  noiseï¼  


P44   

![](./assets/lhy3-44.png)  

<https://arxiv.org/abs/2210.08933>


P45   
## Diffusion Model for Text

 - Solution: Donâ€™t add Gaussian noise 

<https://arxiv.org/abs/2210.16886>

Diffusion via Editï¿¾based Reconstruction (DiffusER)

![](./assets/lhy3-45-1.png)  

![](./assets/lhy3-45-2.png)  


<https://arxiv.org/abs/2107.03006>

> &#x2705; ä¸åŠ é«˜æ–¯å™ªå£°ï¼ŒåŠ  MASKï¼   


P48   
## Mask-Predict 

<https://aclanthology.org/D19-1633/>


![](./assets/lhy3-48.png)  

> &#x2705; æŠŠå‡ ç‡æ¯”è¾ƒä½çš„éƒ¨åˆ†ç›–ä½ï¼Œå†åšä¸€æ¬¡ç”Ÿæˆã€‚   


P49   
## Mask-Predict 

<https://arxiv.org/abs/2202.04200>

<https://arxiv.org/abs/2301.00704>

![](./assets/lhy3-49.png)  

P50   
![](./assets/lhy3-50-1.png)  

![](./assets/lhy3-50-2.png)  

P51   

Scheduled Parallel Decoding with MaskGIT

Sequential Decoding with Autoregressive Transformers


